"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = children;

function walk(node, fn, options) {
  var items = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
  Array.from(node.children).forEach(function (child) {
    var hybrids = child.constructor.hybrids;

    if (hybrids && fn(hybrids)) {
      items.push(child);

      if (options.deep && options.nested) {
        walk(child, fn, options, items);
      }
    } else if (options.deep) {
      walk(child, fn, options, items);
    }
  });
  return items;
}

function children(hybridsOrFn) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
    deep: false,
    nested: false
  };
  var fn = typeof hybridsOrFn === 'function' ? hybridsOrFn : function (hybrids) {
    return hybrids === hybridsOrFn;
  };
  return {
    get: function get(host) {
      return walk(host, fn, options);
    },
    connect: function connect(host, key, invalidate) {
      var observer = new MutationObserver(invalidate);
      observer.observe(host, {
        childList: true,
        subtree: !!options.deep
      });
      return function () {
        observer.disconnect();
      };
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jaGlsZHJlbi5qcyJdLCJuYW1lcyI6WyJ3YWxrIiwibm9kZSIsImZuIiwib3B0aW9ucyIsIml0ZW1zIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGRyZW4iLCJmb3JFYWNoIiwiY2hpbGQiLCJoeWJyaWRzIiwiY29uc3RydWN0b3IiLCJwdXNoIiwiZGVlcCIsIm5lc3RlZCIsImh5YnJpZHNPckZuIiwiZ2V0IiwiaG9zdCIsImNvbm5lY3QiLCJrZXkiLCJpbnZhbGlkYXRlIiwib2JzZXJ2ZXIiLCJNdXRhdGlvbk9ic2VydmVyIiwib2JzZXJ2ZSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJkaXNjb25uZWN0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsU0FBU0EsSUFBVCxDQUFjQyxJQUFkLEVBQW9CQyxFQUFwQixFQUF3QkMsT0FBeEIsRUFBNkM7QUFBQSxNQUFaQyxLQUFZLHVFQUFKLEVBQUk7QUFDM0NDLEVBQUFBLEtBQUssQ0FBQ0MsSUFBTixDQUFXTCxJQUFJLENBQUNNLFFBQWhCLEVBQTBCQyxPQUExQixDQUFrQyxVQUFDQyxLQUFELEVBQVc7QUFDM0MsUUFBTUMsT0FBTyxHQUFHRCxLQUFLLENBQUNFLFdBQU4sQ0FBa0JELE9BQWxDOztBQUNBLFFBQUlBLE9BQU8sSUFBSVIsRUFBRSxDQUFDUSxPQUFELENBQWpCLEVBQTRCO0FBQzFCTixNQUFBQSxLQUFLLENBQUNRLElBQU4sQ0FBV0gsS0FBWDs7QUFDQSxVQUFJTixPQUFPLENBQUNVLElBQVIsSUFBZ0JWLE9BQU8sQ0FBQ1csTUFBNUIsRUFBb0M7QUFDbENkLFFBQUFBLElBQUksQ0FBQ1MsS0FBRCxFQUFRUCxFQUFSLEVBQVlDLE9BQVosRUFBcUJDLEtBQXJCLENBQUo7QUFDRDtBQUNGLEtBTEQsTUFLTyxJQUFJRCxPQUFPLENBQUNVLElBQVosRUFBa0I7QUFDdkJiLE1BQUFBLElBQUksQ0FBQ1MsS0FBRCxFQUFRUCxFQUFSLEVBQVlDLE9BQVosRUFBcUJDLEtBQXJCLENBQUo7QUFDRDtBQUNGLEdBVkQ7QUFZQSxTQUFPQSxLQUFQO0FBQ0Q7O0FBRWMsU0FBU0csUUFBVCxDQUFrQlEsV0FBbEIsRUFBeUU7QUFBQSxNQUExQ1osT0FBMEMsdUVBQWhDO0FBQUVVLElBQUFBLElBQUksRUFBRSxLQUFSO0FBQWVDLElBQUFBLE1BQU0sRUFBRTtBQUF2QixHQUFnQztBQUN0RixNQUFNWixFQUFFLEdBQUcsT0FBT2EsV0FBUCxLQUF1QixVQUF2QixHQUFvQ0EsV0FBcEMsR0FBa0QsVUFBQUwsT0FBTztBQUFBLFdBQUlBLE9BQU8sS0FBS0ssV0FBaEI7QUFBQSxHQUFwRTtBQUNBLFNBQU87QUFDTEMsSUFBQUEsR0FESyxlQUNEQyxJQURDLEVBQ0s7QUFBRSxhQUFPakIsSUFBSSxDQUFDaUIsSUFBRCxFQUFPZixFQUFQLEVBQVdDLE9BQVgsQ0FBWDtBQUFpQyxLQUR4QztBQUVMZSxJQUFBQSxPQUZLLG1CQUVHRCxJQUZILEVBRVNFLEdBRlQsRUFFY0MsVUFGZCxFQUUwQjtBQUM3QixVQUFNQyxRQUFRLEdBQUcsSUFBSUMsZ0JBQUosQ0FBcUJGLFVBQXJCLENBQWpCO0FBRUFDLE1BQUFBLFFBQVEsQ0FBQ0UsT0FBVCxDQUFpQk4sSUFBakIsRUFBdUI7QUFDckJPLFFBQUFBLFNBQVMsRUFBRSxJQURVO0FBQ0pDLFFBQUFBLE9BQU8sRUFBRSxDQUFDLENBQUN0QixPQUFPLENBQUNVO0FBRGYsT0FBdkI7QUFJQSxhQUFPLFlBQU07QUFBRVEsUUFBQUEsUUFBUSxDQUFDSyxVQUFUO0FBQXdCLE9BQXZDO0FBQ0Q7QUFWSSxHQUFQO0FBWUQiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiB3YWxrKG5vZGUsIGZuLCBvcHRpb25zLCBpdGVtcyA9IFtdKSB7XG4gIEFycmF5LmZyb20obm9kZS5jaGlsZHJlbikuZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICBjb25zdCBoeWJyaWRzID0gY2hpbGQuY29uc3RydWN0b3IuaHlicmlkcztcbiAgICBpZiAoaHlicmlkcyAmJiBmbihoeWJyaWRzKSkge1xuICAgICAgaXRlbXMucHVzaChjaGlsZCk7XG4gICAgICBpZiAob3B0aW9ucy5kZWVwICYmIG9wdGlvbnMubmVzdGVkKSB7XG4gICAgICAgIHdhbGsoY2hpbGQsIGZuLCBvcHRpb25zLCBpdGVtcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmRlZXApIHtcbiAgICAgIHdhbGsoY2hpbGQsIGZuLCBvcHRpb25zLCBpdGVtcyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaXRlbXM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNoaWxkcmVuKGh5YnJpZHNPckZuLCBvcHRpb25zID0geyBkZWVwOiBmYWxzZSwgbmVzdGVkOiBmYWxzZSB9KSB7XG4gIGNvbnN0IGZuID0gdHlwZW9mIGh5YnJpZHNPckZuID09PSAnZnVuY3Rpb24nID8gaHlicmlkc09yRm4gOiBoeWJyaWRzID0+IGh5YnJpZHMgPT09IGh5YnJpZHNPckZuO1xuICByZXR1cm4ge1xuICAgIGdldChob3N0KSB7IHJldHVybiB3YWxrKGhvc3QsIGZuLCBvcHRpb25zKTsgfSxcbiAgICBjb25uZWN0KGhvc3QsIGtleSwgaW52YWxpZGF0ZSkge1xuICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihpbnZhbGlkYXRlKTtcblxuICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShob3N0LCB7XG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogISFvcHRpb25zLmRlZXAsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuICgpID0+IHsgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpOyB9O1xuICAgIH0sXG4gIH07XG59XG4iXX0=